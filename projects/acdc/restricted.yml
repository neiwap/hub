version: '2'
services:
  sort:
    extends:
      file: nolinks.yml
      service: sort
    mem_limit: 1G
    blkio_config:
      device_read_bps:
        - path: /dev/sda
          rate: '75mb'
      device_write_bps:
        - path: /dev/sda
          rate: '75mb'
  sysbench:
    extends:
      file: nolinks.yml
      service: sysbench
    links:
      - mysql
      - influxdb
  mysql:
    extends:
      file: nolinks.yml
      service: mysql
    mem_limit: 1G
    blkio_config:
      device_read_bps:
        - path: /dev/sda
          rate: '27mb'
      device_write_bps:
        - path: /dev/sda
          rate: '27mb'
  influxdb:
    extends:
      file: nolinks.yml
      service: influxdb
  collector:
    extends:
      file: nolinks.yml
      service: collector
    links:
      - influxdb
  grafana:
    extends:
      file: nolinks.yml
      service: grafana
    links:
      - influxdb
volumes:
  data-sort:
  data-mysql:
  data-influxdb-var-lib:
  data-influxdb-var-log:
  data-influxdb-etc:
